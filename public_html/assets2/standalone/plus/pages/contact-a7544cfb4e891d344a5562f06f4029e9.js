function PlusForm(t){this.successEvent=t||["Shopify Plus Contact Form","Success"],this.$body=$("body"),this.$form=$(".plus-form"),this.$formInput=$(".plus-form__input, .plus-form__textarea"),this.$formWrappers=$(".plus-form__input-wrapper"),this.$textArea=$(".plus-form__textarea"),this.$requiredFields=$(".js-check-input-field"),this.$nameField=$(".js-check-name-field"),this.$submitButton=$(".plus-form__submit"),this.bindUIActions(),this._checkLabels(),this.$textArea.autosize()}!function(t){"use strict";var e="textarea-helper-caret",o="textarea-helper",i=["box-sizing","height","width","padding-bottom","padding-left","padding-right","padding-top","font-family","font-size","font-style","font-variant","font-weight","word-spacing","letter-spacing","line-height","text-decoration","text-indent","text-transform","direction"],s=function(e){"textarea"===e.nodeName.toLowerCase()&&(this.$text=t(e),this.$mirror=t("<div/>").css({position:"absolute",overflow:"auto","white-space":"pre-wrap","word-wrap":"break-word",top:0,left:-9999}).insertAfter(this.$text))};(function(){this.update=function(){for(var o,s={},r=0;o=i[r];r++)s[o]=this.$text.css(o);this.$mirror.css(s).empty();var n=this.getOriginalCaretPos(),a=this.$text.val(),l=document.createTextNode(a.substring(0,n)),h=document.createTextNode(a.substring(n)),d=t("<span/>").addClass(e).css("position","absolute").html("&nbsp;");this.$mirror.append(l,d,h).scrollTop(this.$text.scrollTop())},this.destroy=function(){return this.$mirror.remove(),this.$text.removeData(o),null},this.caretPos=function(){this.update();var t=this.$mirror.find("."+e),o=t.position();return"rtl"===this.$text.css("direction")&&(o.right=this.$mirror.innerWidth()-o.left-t.width(),o.left="auto"),o},this.height=function(){return this.update(),this.$mirror.css("height",""),this.$mirror.height()},this.getOriginalCaretPos=function(){var t=this.$text[0];if(t.selectionStart)return t.selectionStart;if(document.selection){t.focus();var e=document.selection.createRange();if(null==e)return 0;var o=t.createTextRange(),i=o.duplicate();return o.moveToBookmark(e.getBookmark()),i.setEndPoint("EndToStart",o),i.text.length}return 0}}).call(s.prototype),t.fn.textareaHelper=function(e){if(this.each(function(){var e=t(this),i=e.data(o);i||(i=new s(this),e.data(o,i))}),e){var i=this.first().data(o);return i[e]()}return this}}(jQuery),function(t){var e,o={className:"autosizejs",id:"autosizejs",append:"\n",callback:!1,resizeDelay:10,placeholder:!0},i='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',s=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","whiteSpace"],r=t(i).data("autosize",!0)[0];r.style.lineHeight="99px","99px"===t(r).css("lineHeight")&&s.push("lineHeight"),r.style.lineHeight="",t.fn.autosize=function(i){return this.length?(i=t.extend({},o,i||{}),r.parentNode!==document.body&&t(document.body).append(r),this.each(function(){function o(){var e,o=window.getComputedStyle?window.getComputedStyle(c,null):null;o?(e=parseFloat(o.width),("border-box"===o.boxSizing||"border-box"===o.webkitBoxSizing||"border-box"===o.mozBoxSizing)&&t.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(t,i){e-=parseFloat(o[i])})):e=u.width(),r.style.width=Math.max(e,0)+"px"}function n(){var n={};if(e=c,r.className=i.className,r.id=i.id,h=parseFloat(u.css("maxHeight")),t.each(s,function(t,e){n[e]=u.css(e)}),t(r).css(n).attr("wrap",u.attr("wrap")),o(),window.chrome){var a=c.style.width;c.style.width="0px";c.offsetWidth;c.style.width=a}}function a(){var t,s;e!==c?n():o(),!c.value&&i.placeholder?r.value=u.attr("placeholder")||"":r.value=c.value,r.value+=i.append||"",r.style.overflowY=c.style.overflowY,s=parseFloat(c.style.height)||0,r.scrollTop=0,r.scrollTop=9e4,t=r.scrollTop,h&&t>h?(c.style.overflowY="scroll",t=h):(c.style.overflowY="hidden",d>t&&(t=d)),t+=f,Math.abs(s-t)>.01&&(c.style.height=t+"px",r.className=r.className,m&&i.callback.call(c,c),u.trigger("autosize.resized"))}function l(){clearTimeout(p),p=setTimeout(function(){var t=u.width();t!==g&&(g=t,a())},parseInt(i.resizeDelay,10))}var h,d,p,c=this,u=t(c),f=0,m=t.isFunction(i.callback),y={height:c.style.height,overflow:c.style.overflow,overflowY:c.style.overflowY,wordWrap:c.style.wordWrap,resize:c.style.resize},g=u.width(),b=u.css("resize");u.data("autosize")||(u.data("autosize",!0),("border-box"===u.css("box-sizing")||"border-box"===u.css("-moz-box-sizing")||"border-box"===u.css("-webkit-box-sizing"))&&(f=u.outerHeight()-u.height()),d=Math.max(parseFloat(u.css("minHeight"))-f||0,u.height()),u.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word"}),"vertical"===b?u.css("resize","none"):"both"===b&&u.css("resize","horizontal"),"onpropertychange"in c?"oninput"in c?u.on("input.autosize keyup.autosize",a):u.on("propertychange.autosize",function(){"value"===event.propertyName&&a()}):u.on("input.autosize",a),i.resizeDelay!==!1&&t(window).on("resize.autosize",l),u.on("autosize.resize",a),u.on("autosize.resizeIncludeStyle",function(){e=null,a()}),u.on("autosize.destroy",function(){e=null,clearTimeout(p),t(window).off("resize",l),u.off("autosize").off(".autosize").css(y).removeData("autosize")}),a())})):this}}(jQuery||$),PlusForm.prototype.bindUIActions=function(){this._toggleContentClass=_.bind(this._toggleContentClass,this),this._keyboardSubmit=_.bind(this._keyboardSubmit,this),this.submitForm=_.bind(this.submitForm,this),this.$formInput.on("input change",this._toggleContentClass),this.$body.on("keydown",this._keyboardSubmit),this.$form.on("submit",this.submitForm),this.$formInput.bind("focus",function(){$(this).parent().addClass("js-is-focused")}),this.$formInput.bind("blur",function(){$(this).parent().removeClass("js-is-focused")}),this.$textArea.on("input keyup paste cut mouseup",function(){$(".caret").css($(this).textareaHelper("caretPos"))})},PlusForm.prototype._toggleContentClass=function(t){var e=$(t.currentTarget),o=e.parent();e.val()?o.addClass("js-has-content"):o.removeClass("js-has-content")},PlusForm.prototype._keyboardSubmit=function(t){13===t.keyCode&&(t.ctrlKey||t.metaKey)&&(this.$form.submit(),this.$submitButton.focus())},PlusForm.prototype._checkLabels=function(){this.$formInput.each(function(){var t=$(this);t.val()&&t.parent().addClass("js-has-content")})},PlusForm.prototype.submitForm=function(t){var e=t.currentTarget,o=this;this.submitForm=_.bind(this.submitForm,this),this.handleSuccess=_.bind(this.handleSuccess,this),this.handleFail=_.bind(this.handleFail,this),this._addErrorToField=_.bind(this._addErrorToField,this),this._clearErrors=_.bind(this._clearErrors,this),this._displayPageError=_.bind(this._displayPageError,this),this.$submitButton.prop("disabled",!0),$.ajax({type:"POST",dataType:"json",url:e.action+".json",data:$(e).serialize()}).done(function(t){o.trackResults(e),o.handleSuccess(t)}).fail(this.handleFail),t.preventDefault()},PlusForm.prototype.trackResults=function(t){"PlusContactForm"===t.id&&(ShopifyMarketing.Analytics.track.apply(ShopifyMarketing.Analytics,this.successEvent),window.optimizely&&_.isFunction(window.optimizely.push)&&window.optimizely.push(["trackEvent","ShopifyPlusContactFormSuccess"]))},PlusForm.prototype.handleSuccess=function(t){this.$submitButton.prop("disabled",!1),this.$body.removeClass("plus-form__show-fatal-error"),this.$body.addClass("plus-form__show-message"),this._clearErrors(),t.iframeSrc&&this.$body.append('<iframe style="display:none;" src="'+t.iframeSrc+'"></iframe>')},PlusForm.prototype.handleFail=function(t){this.$submitButton.prop("disabled",!1);var e=t.responseJSON.errors,o=_.keys(e);if(this._clearErrors(),!e)return void this._displayPageError();for(var i=0;i<o.length;i++){var s=o[i],r=$("[name='application["+s+"]']");this._addErrorToField(r,e[s])}$(".js-has-error").length?$(".js-has-error")[0].focus():this._displayPageError()},PlusForm.prototype._addErrorToField=function(t,e){var o=t.parent(),i=o.find(".plus-form__error-message"),s=i.find(".plus-form__error-message-text");o.addClass("js-has-error"),i.removeClass("hidden"),s.text(e)},PlusForm.prototype._clearErrors=function(){this.$formWrappers.removeClass("js-has-error").find(".plus-form__error-message-text").empty()},PlusForm.prototype._displayPageError=function(){this.$body.addClass("plus-form__show-fatal-error")},$(function(){new PlusForm}),ShopifyMarketing.Helpers.Cookie=function(t){t||(t={}),"string"==typeof t&&(t={cookie:t}),void 0===t.cookie&&(t.cookie="");var e={};return e.get=function(e){for(var o=t.cookie.split(/;\s*/),i=0;i<o.length;i++){var s=o[i].split("="),r=decodeURIComponent(s[0]);if(r===e)return decodeURIComponent(s[1])}return void 0},e.set=function(e,o,i){var s=encodeURIComponent(e)+"="+encodeURIComponent(o);return i||(i={}),i.expires&&(s+="; expires="+i.expires),i.path&&(s+="; path="+encodeURIComponent(i.path)),t.cookie=s,s},e}(document),ShopifyMarketing.InterstitialModal=function(){var t=ShopifyMarketing.Helpers.Cookie,e=function(t,e){this.$template=t,this.options=e||{},this.$trigger=$([]),this.$body=$("body"),this.activeClass="js-interstitial-modal-active",$("body").on("click",".js-close-modal",_.bind(this.close,this,{fromCta:!0})),ShopifyMarketing.Modal.call(this,this.$trigger,_.bind(this.template,this),_.extend({clickingOverlayClosesModal:!1},this.options))};return e.prototype=_.clone(ShopifyMarketing.Modal.prototype),e.prototype.open=function(){this.options.showOncePerSession&&this.clientHasViewedInterstitial()||(this.$body.addClass(this.activeClass),ShopifyMarketing.Modal.prototype.open.apply(this,arguments))},e.prototype.close=function(t){t=t||{},ShopifyMarketing.Modal.prototype.close.call(this,_.bind(function(){this.$body.removeClass(this.activeClass)},this)),this.options.showOncePerSession&&t.fromCta&&this.setClientHasViewedCookie()},e.prototype.template=function(){return this.$template.clone().removeAttr("style id").get(0).outerHTML},e.prototype.clientHasViewedInterstitial=function(){return!!t.get(this.options.cookie)},e.prototype.setClientHasViewedCookie=function(){t.set(this.options.cookie,1)},e}(),$(window).on("unload",function(){var t=new Date;t.setDate(t.getDate()-1),ShopifyMarketing.Helpers.Cookie.set("header_message",null,{expires:t,path:"/"})}),$(function(){var t=$("#InterstitialModalTemplate");if(t.length){var e=new ShopifyMarketing.InterstitialModal(t);e.open()}});